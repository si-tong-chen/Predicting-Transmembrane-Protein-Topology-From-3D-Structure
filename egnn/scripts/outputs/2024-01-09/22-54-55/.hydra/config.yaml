models:
  num_layers: 6
  emb_dim: 128
  node_s_emb_dim: ${.emb_dim}
  node_v_emb_dim: 16
  edge_s_emb_dim: 32
  edge_v_emb_dim: 4
  r_max: 10.0
  num_rbf: 8
  activation: silu
  pool: sum
  module_cfg:
    norm_pos_diff: true
    scalar_gate: 0
    vector_gate: true
    scalar_nonlinearity: ${..activation}
    vector_nonlinearity: ${..activation}
    nonlinearities:
    - ${..scalar_nonlinearity}
    - ${..vector_nonlinearity}
    r_max: ${..r_max}
    num_rbf: ${..num_rbf}
    bottleneck: 4
    vector_linear: true
    vector_identity: true
    default_bottleneck: 4
    predict_node_positions: false
    predict_node_rep: true
    node_positions_weight: 1.0
    update_positions_with_vector_sum: false
    enable_e3_equivariance: false
    pool: ${..pool}
  model_cfg:
    h_input_dim: 1
    chi_input_dim: 2
    e_input_dim: 9
    xi_input_dim: 1
    h_hidden_dim: ${..node_s_emb_dim}
    chi_hidden_dim: ${..node_v_emb_dim}
    e_hidden_dim: ${..edge_s_emb_dim}
    xi_hidden_dim: ${..edge_v_emb_dim}
    num_layers: ${..num_layers}
    dropout: 0.0
  layer_cfg:
    pre_norm: false
    use_gcp_norm: true
    use_gcp_dropout: true
    use_scalar_message_attention: true
    num_feedforward_layers: 2
    dropout: 0.0
    nonlinearity_slope: 0.01
    mp_cfg:
      edge_encoder: false
      edge_gate: false
      num_message_layers: 4
      message_residual: 0
      message_ff_multiplier: 1
      self_message: true
labels:
  path: /Users/chensitong/DL/gcpnet
  file_name: DeepTMHMM.3line
  setup: setup1
  batch_size: 1
train:
  epochs: 100
  lr: 0.0001
  weight_decay: 0.0001
